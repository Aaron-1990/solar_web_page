{% extends "base.html" %}

{% block title %}Sun Depot - Calcula tu Ahorro Total en Hogar y Transporte{% endblock %}

{% block content %}
    <!-- HERO SECTION -->
    <section class="hero-section">
        <div class="hero-content">
            <h1 class="hero-title">Descubre el Poder del Sol en tu Hogar</h1>
            <h2 class="hero-subtitle">Energ√≠a Solar y Limpia</h2>
            <p class="hero-description">
                Calcula cu√°ntos paneles solares necesitas para reducir tu factura de luz y 
                contribuir a un planeta m√°s verde. ¬°Es f√°cil y r√°pido!
            </p>
            <a href="#calculator" class="hero-cta">Ir a la Calculadora Solar</a>
            <div class="hero-stats">
                <div class="stat-card">
                    <div class="stat-number">67.3%</div>
                    <div class="stat-label">Crecimiento Energ√≠a Limpia</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">5.5</div>
                    <div class="stat-label">HSP promedio M√©xico</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">100%</div>
                    <div class="stat-label">Deducci√≥n ISR</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">25%</div>
                    <div class="stat-label">Incentivo SENER</div>
                </div>
            </div>
        </div>
    </section>

    <!-- CALCULADORA -->
    <section class="calculator-main" id="calculator">
        <div class="container">
            <h2 class="section-title">üßÆ Calculadora de Ahorro Solar</h2>
            <p class="section-subtitle">Calcula tu sistema solar personalizado</p>
            
            <!-- ========================================
            SECCI√ìN DE SELECCI√ìN DE PANELES SOLARES
            Reemplazar la secci√≥n "PASO 1: DATOS DEL HOGAR" existente
            ======================================== -->

            <div class="calculator-card">
                <div class="card-header">
                    <h3>üè† Paso 1: Datos de tu Hogar</h3>
                    <span class="required-badge">Requerido</span>
                </div>
                <div class="card-content">
                    <!-- Datos b√°sicos del hogar -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="homeConsumption">
                                Consumo el√©ctrico bimestral (kWh)
                                <span class="field-help">Revisa tu recibo de CFE</span>
                            </label>
                            <input type="number" id="homeConsumption" placeholder="Ej: 400" value="400">
                        </div>
                        <div class="form-group">
                            <label for="location">
                                Ubicaci√≥n (Estado)
                                <span class="field-help">Para calcular las horas de sol</span>
                            </label>
                            <select id="location">
                                <option value="">Selecciona tu estado</option>
                                {% for loc in locations %}
                                <option value="{{ loc.value }}" data-hsp="{{ loc.hsp }}">{{ loc.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="coverage">
                                Porcentaje de cobertura deseado
                                <span class="field-help">¬øCu√°nto quieres reducir tu factura?</span>
                            </label>
                            <select id="coverage">
                                <option value="50">50% - Ahorro moderado</option>
                                <option value="75">75% - Buen ahorro</option>
                                <option value="100" selected>100% - M√°ximo ahorro</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- NUEVA SECCI√ìN: CONFIGURACI√ìN DE PANELES SOLARES -->
                    <div class="panel-selection-section">
                        <h4 class="subsection-title">‚ö° Configuraci√≥n de Paneles Solares</h4>
                        
                        <div class="form-group">
                            <label for="panelType">
                                Tipo de panel solar
                                <span class="field-help">Selecciona la potencia que prefieras - afecta la cantidad de paneles necesarios</span>
                            </label>
                            <select id="panelType">
                                <option value="450w">Panel 450W (Est√°ndar)</option>
                                <option value="500w" selected>Panel 500W (Alta Eficiencia)</option>
                                <option value="550w">Panel 550W (Premium)</option>
                                <option value="600w">Panel 600W (Ultra Premium)</option>
                            </select>
                        </div>
                        
                        <!-- Tarjeta de informaci√≥n del panel seleccionado -->
                        <div class="panel-info-card" id="panelInfoCard">
                            <div class="panel-specs">
                                <div class="spec-item">
                                    <span class="spec-label">Potencia:</span>
                                    <span class="spec-value" id="panelPower">500W</span>
                                </div>
                                <div class="spec-item">
                                    <span class="spec-label">Eficiencia:</span>
                                    <span class="spec-value" id="panelEfficiency">21.8%</span>
                                </div>
                                <div class="spec-item">
                                    <span class="spec-label">√Årea:</span>
                                    <span class="spec-value" id="panelArea">2.4 m¬≤</span>
                                </div>
                                <div class="spec-item">
                                    <span class="spec-label">Tecnolog√≠a:</span>
                                    <span class="spec-value" id="panelTech">Half-Cell</span>
                                </div>
                            </div>
                            
                            <!-- Descripci√≥n del panel -->
                            <div class="panel-description" id="panelDescription">
                                Panel solar de alta eficiencia, mejor relaci√≥n costo-beneficio
                            </div>
                            
                            <!-- Hint de comparaci√≥n -->
                            <div class="panel-comparison-hint">
                                <div class="comparison-metric">
                                    <span class="metric-label">Generaci√≥n estimada</span>
                                    <span class="metric-value" id="panelDailyGen">2.5 kWh/d√≠a</span>
                                </div>
                                <div class="comparison-metric">
                                    <span class="metric-label">Densidad de potencia</span>
                                    <span class="metric-value" id="panelPowerDensity">208 W/m¬≤</span>
                                </div>
                                <div class="comparison-metric">
                                    <span class="metric-label">Garant√≠a</span>
                                    <span class="metric-value" id="panelWarranty">25 a√±os</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PASO 2: VEH√çCULO EL√âCTRICO (OPCIONAL) -->
            <div class="calculator-card optional">
                <div class="card-header toggle-header" onclick="toggleVehicleSection()">
                    <div class="header-left">
                        <h3>üöó Paso 2: ¬øTienes veh√≠culo el√©ctrico o h√≠brido?</h3>
                        <span class="optional-badge">Opcional</span>
                    </div>
                    <div class="toggle-container">
                        <span class="toggle-text" id="vehicleToggleText">No incluir</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="includeVehicle" onchange="toggleVehicleSection()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="card-content" id="vehicleContent" style="display: none;">
                    <!-- Selector de modo -->
                    <div class="mode-tabs">
                        <button class="mode-tab active" onclick="selectVehicleMode('simple')">
                            <span class="tab-icon">üöò</span>
                            <span class="tab-text">Modo Simple</span>
                        </button>
                        <button class="mode-tab" onclick="selectVehicleMode('advanced')">
                            <span class="tab-icon">‚ö°</span>
                            <span class="tab-text">Modo Avanzado</span>
                        </button>
                    </div>

                    <!-- MODO SIMPLE -->
                    <div id="simpleVehicleMode" class="vehicle-mode-panel">
                        <div class="form-group">
                            <label for="vehicleModel">Selecciona tu veh√≠culo</label>
                            <select id="vehicleModel" onchange="handleVehicleSelection()">
                                <option value="">Elige un modelo</option>
                                {% for vehicle in vehicles %}
                                <option value="{{ vehicle.value }}">{{ vehicle.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <!-- MODO AVANZADO -->
                    <div id="advancedVehicleMode" class="vehicle-mode-panel" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="consumptionInput">
                                    Consumo el√©ctrico
                                    <span class="field-help">kWh por cada 100 km</span>
                                </label>
                                <div class="input-with-unit">
                                    <input type="number" id="consumptionInput" step="0.1" placeholder="15.5">
                                    <span class="unit">kWh/100km</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="customVehicleName">
                                    Nombre del veh√≠culo
                                    <span class="field-help">Opcional</span>
                                </label>
                                <input type="text" id="customVehicleName" placeholder="Mi auto el√©ctrico">
                            </div>
                        </div>
                        
                        <!-- Calculadora de eficiencia -->
                        <div class="efficiency-calculator">
                            <p class="helper-text">¬øNo conoces el consumo? Calcula aqu√≠:</p>
                            <div class="form-row">
                                <div class="form-group small">
                                    <label for="batteryHelper">Bater√≠a (kWh)</label>
                                    <input type="number" id="batteryHelper" step="0.1" placeholder="40">
                                </div>
                                <div class="form-group small">
                                    <label for="rangeHelper">Autonom√≠a (km)</label>
                                    <input type="number" id="rangeHelper" placeholder="300">
                                </div>
                                <button type="button" class="calc-helper-btn" onclick="calculateEfficiency()">
                                    Calcular
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Kil√≥metros diarios (visible para ambos modos) -->
                    <div class="form-group" id="dailyKmSection" style="display: none;">
                        <label for="dailyEvKm">
                            ¬øCu√°ntos kil√≥metros recorres al d√≠a?
                            <span class="field-help">En modo el√©ctrico</span>
                        </label>
                        <div class="km-slider-container">
                            <input type="range" id="kmSlider" min="0" max="200" value="40" oninput="updateKmValue()">
                            <div class="km-display">
                                <input type="number" id="dailyEvKm" value="40" min="0" max="500" onchange="updateKmSlider()">
                                <span class="unit">km/d√≠a</span>
                            </div>
                        </div>
                        <div class="km-presets">
                            <button type="button" class="preset-btn" onclick="setKm(20)">20 km</button>
                            <button type="button" class="preset-btn" onclick="setKm(40)">40 km</button>
                            <button type="button" class="preset-btn" onclick="setKm(60)">60 km</button>
                            <button type="button" class="preset-btn" onclick="setKm(100)">100 km</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BOT√ìN DE CALCULAR -->
            <div class="calculate-section">
                <button class="calculate-btn" onclick="calculateIntegral()">
                    <span class="btn-icon">‚ö°</span>
                    <span class="btn-text">Calcular Mi Sistema Solar</span>
                </button>
                <p class="calculate-hint">
                    <span id="calculationMode">Calculando solo para tu hogar</span>
                </p>
            </div>

            <!-- RESULTADOS -->
            <div class="results-section" id="results">
                <h3 class="section-title">üìä Resultados de tu Sistema Solar</h3>
                <div class="results-summary" id="resultsSummary"></div>
                <div class="results-grid" id="resultsGrid"></div>
            </div>
            <!-- NUEVO: AGREGAR ESTA SECCI√ìN COMPLETA -->
            <div class="cost-disclaimer-section" id="costDisclaimer" style="display: none;">
                <div class="disclaimer-card">
                    <div class="disclaimer-header">
                        <h4>üí° Informaci√≥n Importante sobre Costos</h4>
                    </div>
                    <div class="disclaimer-content">
                        <div class="disclaimer-grid">
                            <div class="disclaimer-item">
                                <div class="disclaimer-icon">üìä</div>
                                <div class="disclaimer-text">
                                    <h5>Precios de Referencia</h5>
                                    <p>Los costos mostrados son <strong>estimaciones generales</strong> basadas en promedios del mercado mexicano.</p>
                                </div>
                            </div>
                            <div class="disclaimer-item">
                                <div class="disclaimer-icon">üìã</div>
                                <div class="disclaimer-text">
                                    <h5>Cotizaci√≥n Personalizada</h5>
                                    <p>Cada proyecto requiere una <strong>cotizaci√≥n espec√≠fica</strong> que considera tu ubicaci√≥n, instalaci√≥n y equipos particulares.</p>
                                </div>
                            </div>
                            <div class="disclaimer-item">
                                <div class="disclaimer-icon">üè†</div>
                                <div class="disclaimer-text">
                                    <h5>Factores Variables</h5>
                                    <p>El costo final depende de: tipo de techo, distancia el√©ctrica, permisos locales, y configuraci√≥n espec√≠fica.</p>
                                </div>
                            </div>
                            <div class="disclaimer-item">
                                <div class="disclaimer-icon">üìà</div>
                                <div class="disclaimer-text">
                                    <h5>Precios Actualizados</h5>
                                    <p>Los precios de equipos var√≠an constantemente por fluctuaciones del mercado internacional y tipo de cambio.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="action-section">
                            <h5>üéØ Recomendaci√≥n</h5>
                            <p>Usa estos n√∫meros como <strong>referencia inicial</strong>. Para una cotizaci√≥n precisa, contacta directamente con instaladores certificados de tu zona.</p>
                            <button class="quote-cta-btn" onclick="showQuoteOptions()">
                                <span class="btn-icon">üìû</span>
                                <span class="btn-text">Obtener Cotizaci√≥n Precisa</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MODAL PARA OPCIONES DE COTIZACI√ìN -->
            <div class="quote-modal" id="quoteModal" style="display: none;">
                <div class="modal-overlay" onclick="closeQuoteModal()"></div>
                <div class="modal-content">
                    <div class="modal-header">
                        <h4>üîç Obt√©n tu Cotizaci√≥n Personalizada</h4>
                        <button class="modal-close" onclick="closeQuoteModal()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p>Te conectamos con instaladores certificados de tu zona para obtener precios reales y actualizados:</p>
                        
                        <div class="quote-options">
                            <div class="quote-option">
                                <h5>üìß Solicitar por Email</h5>
                                <p>Enviamos tu c√°lculo a instaladores locales</p>
                                <button class="option-btn" onclick="requestEmailQuote()">Enviar Solicitud</button>
                            </div>
                            
                            <div class="quote-option">
                                <h5>üìû Llamada Directa</h5>
                                <p>Programa una consulta telef√≥nica gratuita</p>
                                <button class="option-btn" onclick="scheduleCall()">Programar Llamada</button>
                            </div>
                            
                            <div class="quote-option">
                                <h5>üè™ Instaladores Recomendados</h5>
                                <p>Contacta directamente con nuestros partners</p>
                                <button class="option-btn" onclick="showInstallers()">Ver Instaladores</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- EQUIPAMIENTO SOLAR -->
    <section class="commercial-section" id="equipamiento">
        <div class="container">
            <div class="category-header">
                <h2 class="category-title">‚òÄÔ∏è Equipamiento Solar Recomendado</h2>
                <p class="category-description">Sistemas de paneles solares de calidad certificada con garant√≠as extendidas</p>
            </div>
            <div class="partners-container">
                <div class="partner-tabs">
                    <button class="partner-tab active" onclick="switchPartner('equipamiento', 'premium')">üèÜ Premium</button>
                    <button class="partner-tab" onclick="switchPartner('equipamiento', 'distribuidores')">üè™ Distribuidores</button>
                    <button class="partner-tab" onclick="switchPartner('equipamiento', 'fide')">üèõÔ∏è Programa FIDE</button>
                </div>
                
                <!-- Contenido est√°tico por ahora -->
                <div class="partner-content active" id="equipamiento-premium">
                    <div class="products-grid">
                        <div class="product-card">
                            <div class="partner-badge">La Bodega Solar</div>
                            <div class="product-image">Kit Solar Premium 5kW</div>
                            <div class="product-info">
                                <h4 class="product-title">Sistema Solar Residencial 5kW</h4>
                                <p class="product-price">Desde $95,000 MXN</p>
                                <p class="product-description">13 paneles de 385W con microinversores. Ideal para hogares con consumo medio-alto.</p>
                                <div class="product-features">
                                    <span class="feature-tag">‚úì Garant√≠a 25 a√±os</span>
                                    <span class="feature-tag">‚úì Instalaci√≥n incluida</span>
                                    <span class="feature-tag">‚úì Monitoreo WiFi</span>
                                </div>
                                <a href="#" class="cta-button" onclick="trackClick('labodegasolar', 'kit-5kw')">Ver en La Bodega Solar</a>
                            </div>
                        </div>
                        <div class="product-card">
                            <div class="partner-badge">Solarama</div>
                            <div class="product-image">Kit Solar 3kW</div>
                            <div class="product-info">
                                <h4 class="product-title">Kit Solar B√°sico 3kW</h4>
                                <p class="product-price">Desde $65,000 MXN</p>
                                <p class="product-description">8 paneles de 375W perfecto para iniciar en energ√≠a solar.</p>
                                <div class="product-features">
                                    <span class="feature-tag">‚úì Instalaci√≥n r√°pida</span>
                                    <span class="feature-tag">‚úì Tr√°mites CFE</span>
                                </div>
                                <a href="#" class="cta-button" onclick="trackClick('solarama', 'kit-3kw')">Cotizar en Solarama</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="partner-content" id="equipamiento-distribuidores">
                    <div class="products-grid">
                        <div class="product-card">
                            <div class="partner-badge">Amazon</div>
                            <div class="product-image">Paneles Amazon</div>
                            <div class="product-info">
                                <h4 class="product-title">Paneles Solares Individuales</h4>
                                <p class="product-price">Desde $3,500 MXN/panel</p>
                                <p class="product-description">Paneles solares de alta eficiencia para proyectos DIY.</p>
                                <a href="#" class="cta-button amazon" onclick="trackClick('amazon', 'paneles-individuales')">Ver en Amazon</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="partner-content" id="equipamiento-fide">
                    <div class="products-grid">
                        <div class="product-card">
                            <div class="partner-badge">FIDE Oficial</div>
                            <div class="product-image">Programa FIDE</div>
                            <div class="product-info">
                                <h4 class="product-title">Sistema FIDE Certificado</h4>
                                <p class="product-price">25% descuento + financiamiento</p>
                                <p class="product-description">Programa gubernamental oficial con incentivos m√°ximos.</p>
                                <a href="#" class="cta-button" onclick="trackClick('fide', 'programa-oficial')">Programa FIDE</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- BENEFICIOS -->
    <section class="benefits-section">
        <div class="container">
            <h2 class="section-title" style="color: white;">üåü Beneficios de la Sinergia Solar + Veh√≠culo El√©ctrico</h2>
            <div class="benefits-grid">
                <div class="benefit-card">
                    <div class="benefit-icon">üí∞</div>
                    <h3 class="benefit-title">Doble Ahorro</h3>
                    <p>Reduce gastos en gasolina y electricidad dom√©stica simult√°neamente. Ahorra hasta $3,000 MXN mensuales.</p>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">üå±</div>
                    <h3 class="benefit-title">Cero Emisiones</h3>
                    <p>Tu veh√≠culo el√©ctrico funcionar√° 100% con energ√≠a limpia del sol. Contribuye al planeta verde.</p>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">üîã</div>
                    <h3 class="benefit-title">Independencia Energ√©tica</h3>
                    <p>Genera tu propia electricidad y reduce dependencia de CFE y gasolineras.</p>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">üìà</div>
                    <h3 class="benefit-title">Valor de Propiedad</h3>
                    <p>Aumenta el valor de tu casa con tecnolog√≠a sustentable y sistema de carga vehicular.</p>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">‚ö°</div>
                    <h3 class="benefit-title">Carga Nocturna Gratuita</h3>
                    <p>Con bater√≠as solares, carga tu veh√≠culo gratis durante la noche con energ√≠a almacenada del d√≠a.</p>
                </div>
                <div class="benefit-card">
                    <div class="benefit-icon">üéØ</div>
                    <h3 class="benefit-title">ROI Acelerado</h3>
                    <p>El sistema se paga m√°s r√°pido al cubrir tanto consumo dom√©stico como de transporte.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- INCENTIVOS -->
    <section class="incentives-section">
        <div class="container">
            <h2 class="section-title" style="color: white;">üéØ Incentivos Gubernamentales Vigentes 2025</h2>
            <div class="incentive-item">
                <h3>üöó Para tu Veh√≠culo El√©ctrico/H√≠brido:</h3>
                <ul>
                    <li>‚úÖ Exenci√≥n completa del ISAN</li>
                    <li>‚úÖ Reducci√≥n/exenci√≥n del impuesto sobre tenencia</li>
                    <li>‚úÖ Exento del "Hoy No Circula"</li>
                    <li>‚úÖ Sin verificaci√≥n vehicular</li>
                </ul>
            </div>
            <div class="incentive-item">
                <h3>‚òÄÔ∏è Para tu Sistema Solar:</h3>
                <ul>
                    <li>üí∞ SENER-FIDE: 25% de incentivo directo</li>
                    <li>üè¶ Financiamiento preferencial TIIE + 4.5%</li>
                    <li>üìä Deducci√≥n fiscal del 100% en ISR</li>
                    <li>‚ö° Net Metering con CFE</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- NEWSLETTER -->
    <section class="newsletter-section">
        <div class="container">
            <h3>üöÄ ¬°Mantente al d√≠a con las √∫ltimas oportunidades!</h3>
            <p>Recibe ofertas exclusivas, nuevos productos y tips de ahorro energ√©tico</p>
            <div class="newsletter-form">
                <input type="email" id="emailNewsletter" placeholder="tu@email.com">
                <button onclick="subscribeNewsletter()">Suscribirme</button>
            </div>
            <p class="newsletter-benefits">‚ú® Descuento del 10% en tu primera compra ¬∑ üìä Calculadoras avanzadas gratis ¬∑ üéÅ Ebooks exclusivos</p>
        </div>
    </section>
{% endblock %}